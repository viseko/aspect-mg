/*!
  * Button visually impaired - v1.0.0 https://bvi.isvek.ru
  * Copyright 2014-2022 Oleg Korotenko <bvi@isvek.ru>.
  * Licensed MIT (https://github.com/veks/button-visually-impaired-javascript/blob/master/LICENSE.md)
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).isvek=t()}(this,function(){"use strict";var e={exports:{}};function t(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function i(i){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?t(Object(o),!0).forEach(function(e){var t,n;t=i,e=o[n=e],n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(o,e))})}return i}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,t=function(){};return{s:t,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return r=e.done,e},e:function(e){a=!0,o=e},f:function(){try{r||null==n.return||n.return()}finally{if(a)throw o}}}}!function(){var t=function(a){var l,e=Object.prototype,s=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},i=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",o=t.toStringTag||"@@toStringTag";function r(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{r({},"")}catch(e){r=function(e,t,n){return e[t]=n}}function c(e,t,n,i){var o,r,a,c,t=t&&t.prototype instanceof b?t:b,t=Object.create(t.prototype),i=new B(i||[]);return t._invoke=(o=e,r=n,a=i,c=v,function(e,t){if(c===h)throw new Error("Generator is already running");if(c===d){if("throw"===e)throw t;return O()}for(a.method=e,a.arg=t;;){var n=a.delegate;if(n){var i=function e(t,n){var i=t.iterator[n.method];if(i===l){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=l,e(t,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}i=u(i,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var i=i.arg;if(!i)return n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m;{if(!i.done)return i;n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=l)}n.delegate=null;return m}(n,a);if(i){if(i===m)continue;return i}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(c===v)throw c=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);c=h;i=u(o,r,a);if("normal"===i.type){if(c=a.done?d:f,i.arg!==m)return{value:i.arg,done:a.done}}else"throw"===i.type&&(c=d,a.method="throw",a.arg=i.arg)}}),t}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}a.wrap=c;var v="suspendedStart",f="suspendedYield",h="executing",d="completed",m={};function b(){}function p(){}function g(){}var y={};r(y,i,function(){return this});t=Object.getPrototypeOf,t=t&&t(t(E([])));t&&t!==e&&s.call(t,i)&&(y=t);var S=g.prototype=b.prototype=Object.create(y);function _(e){["next","throw","return"].forEach(function(t){r(e,t,function(e){return this._invoke(t,e)})})}function k(a,c){var t;this._invoke=function(n,i){function e(){return new c(function(e,t){!function t(e,n,i,o){e=u(a[e],a,n);if("throw"!==e.type){var r=e.arg,n=r.value;return n&&"object"==typeof n&&s.call(n,"__await")?c.resolve(n.__await).then(function(e){t("next",e,i,o)},function(e){t("throw",e,i,o)}):c.resolve(n).then(function(e){r.value=e,i(r)},function(e){return t("throw",e,i,o)})}o(e.arg)}(n,i,e,t)})}return t=t?t.then(e,e):e()}}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function B(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function E(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,e=function e(){for(;++n<t.length;)if(s.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=l,e.done=!0,e};return e.next=e}}return{next:O}}function O(){return{value:l,done:!0}}return r(S,"constructor",p.prototype=g),r(g,"constructor",p),p.displayName=r(g,o,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,r(e,o,"GeneratorFunction")),e.prototype=Object.create(S),e},a.awrap=function(e){return{__await:e}},_(k.prototype),r(k.prototype,n,function(){return this}),a.AsyncIterator=k,a.async=function(e,t,n,i,o){void 0===o&&(o=Promise);var r=new k(c(e,t,n,i),o);return a.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},_(S),r(S,o,"Generator"),r(S,i,function(){return this}),r(S,"toString",function(){return"[object Generator]"}),a.keys=function(n){var e,i=[];for(e in n)i.push(e);return i.reverse(),function e(){for(;i.length;){var t=i.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=E,B.prototype={constructor:B,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=l)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function e(e,t){return r.type="throw",r.arg=n,i.next=e,t&&(i.method="next",i.arg=l),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],r=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var a=s.call(o,"catchLoc"),c=s.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&s.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=e,r.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i,o=n.completion;return"throw"===o.type&&(i=o.arg,L(n)),i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=l),m}},a}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),n=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;n.appendChild(t?e:document.createTextNode(String(e)))}),this.insertBefore(n,this.firstChild)}})}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),window.HTMLCollection&&!HTMLCollection.prototype.forEach&&(HTMLCollection.prototype.forEach=Array.prototype.forEach);function s(r,a,i){Object.keys(a).forEach(function(e){var t,n,i=a[e],o=r[e],t=!o||(!(n=o)||"object"!==c(n)||void 0===n.nodeType)?null==(t=o)?"".concat(t):{}.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase():"element";if(!new RegExp(i).test(t))throw new TypeError('Bvi console: Опция "'.concat(e,'" предоставленный тип "').concat(t,'", ожидаемый тип "').concat(i,'".'))}),Object.keys(i).forEach(function(e){var t=i[e],n=r[e];if(!new RegExp(t).test(n))throw new TypeError('Bvi console: Опция "'.concat(e,'" параметр "').concat(n,'", ожидаемый параметр "').concat(t,'".'))})}function u(e){switch(e){case"on":case"true":case"1":return 1;default:return}}function v(e,t,n){for("string"==typeof t&&(t=document.createElement(t)),e.appendChild(t).className=n;e.firstChild!==t;)t.appendChild(e.firstChild)}function f(e){var t=document.createDocumentFragment();if(e){for(;e.firstChild;){var n=e.removeChild(e.firstChild);t.appendChild(n)}e.parentNode.replaceChild(t,e)}}function h(e,t){Object.keys(e).forEach(function(e){"function"==typeof t&&t(e)})}function d(e,t){Array.from(e).forEach(function(e){"function"==typeof t&&t(e)})}function m(){return window.speechSynthesis}function b(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=new Date,i=n.getTime();i+=864e5,n.setTime(i),document.cookie="bvi_".concat(e,"=").concat(t,",path=/,expires=").concat(n.toUTCString(),",domain=").concat(location.host)}function p(){for(var e="bvi_".concat(e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"","="),t=decodeURIComponent(document.cookie).split(";"),n=0;n<t.length;n++){var i=t[n].trim();if(-1!==i.indexOf(e)){i=i.split(",");return i[0].substring(e.length,i[0].length)}}}function g(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";document.cookie="bvi_".concat(e,"=,path=/,expires=Thu, 01 Jan 1970 00:00:01 GMT,domain=").concat(location.host)}var y={"ru-RU":{text:{fontSize:"Размер шрифта",siteColors:"Цвета сайта",images:"Изображения",speech:"Синтез речи",settings:"Настройки",regularVersionOfTheSite:"Обычная версия сайта",letterSpacing:"Межбуквенное расстояние",normal:"Стандартный",average:"Средний",big:"Большой",lineHeight:"Межстрочный интервал",font:"Шрифт",arial:"Без засечек",times:"С засечками",builtElements:"Встроенные элементы (Видео, карты и тд.)",on:"Включить",off:"Выключить",reset:"Сбросить настройки",plural_0:"пиксель",plural_1:"пекселя",plural_2:"пикселей"},voice:{fontSizePlus:"Размер шрифта увели́чен",fontSizeMinus:"Размер шрифта уме́ньшен",siteColorBlackOnWhite:"Цвет сайта черным по белому",siteColorWhiteOnBlack:"Цвет сайта белым по черному",siteColorDarkBlueOnBlue:"Цвет сайта тёмно-синим по голубому",siteColorBeigeBrown:"Цвет сайта кори́чневым по бе́жевому",siteColorGreenOnDarkBrown:"Цвет сайта зеленым по тёмно-коричневому",imagesOn:"Изображения включены",imagesOFF:"Изображения выключены",imagesGrayscale:"Изображения чёрно-белые",speechOn:"Синтез речи включён",speechOff:"Синтез речи вы́ключен",lineHeightNormal:"Межстрочный интервал стандартный",lineHeightAverage:"Межстрочный интервал средний",lineHeightBig:"Межстрочный интервал большой",LetterSpacingNormal:"Интервал между буквами стандартный",LetterSpacingAverage:"Интервал между буквами средний",LetterSpacingBig:"Интервал между буквами большой",fontArial:"Шрифт без засечек",fontTimes:"Шрифт с засечками",builtElementsOn:"Встроенные элементы включены",builtElementsOFF:"Встроенные элементы выключены",resetSettings:"Установлены настройки по умолча́нию",panelShow:"Панель открыта",panelHide:"Панель скрыта",panelOn:"Версия сайта для слабови́дящий",panelOff:"Обычная версия сайта"}},"en-US":{text:{fontSize:"Font size",siteColors:"Site colors",images:"Images",speech:"Speech synthesis",settings:"Settings",regularVersionOfTheSite:"Regular version Of The site",letterSpacing:"Letter spacing",normal:"Single",average:"One and a half",big:"Double",lineHeight:"Line spacing",font:"Font",arial:"Sans Serif - Arial",times:"Serif - Times New Roman",builtElements:"Include inline elements (Videos, maps, etc.)",on:"Enable",off:"Disabled",reset:"Reset settings",plural_0:"pixel",plural_1:"pixels",plural_2:"pixels"},voice:{fontSizePlus:"Font size increased",fontSizeMinus:"Font size reduced",siteColorBlackOnWhite:"Site color black on white",siteColorWhiteOnBlack:"Site color white on black",siteColorDarkBlueOnBlue:"Site color dark blue on cyan",siteColorBeigeBrown:"SiteColorBeigeBrown",siteColorGreenOnDarkBrown:"Site color green on dark brown",imagesOn:"Images enable",imagesOFF:"Images disabled",imagesGrayscale:"Images gray scale",speechOn:"Synthesis speech enable",speechOff:"Synthesis speech disabled",lineHeightNormal:"Line spacing single",lineHeightAverage:"Line spacing one and a half",lineHeightBig:"Line spacing double",LetterSpacingNormal:"Letter spacing single",LetterSpacingAverage:"Letter spacing one and a half",LetterSpacingBig:"Letter spacing letter double",fontArial:"Sans Serif - Arial",fontTimes:"Serif - Times New Roman",builtElementsOn:"Include inline elements are enabled",builtElementsOFF:"Include inline elements are disabled",resetSettings:"Default settings have been set",panelShow:"Panel show",panelHide:"Panel hide",panelOn:"Site version for visually impaired",panelOff:"Regular version of the site"}}},S=function(){function t(e){n(this,t),this._config=e}return r(t,[{key:"t",value:function(e){return y[this._config.lang].text[e]}},{key:"v",value:function(e){return y[this._config.lang].voice[e]}}]),t}(),_={target:".bvi-open",fontSize:16,theme:"white",images:"grayscale",letterSpacing:"normal",lineHeight:"normal",speech:!0,fontFamily:"arial",builtElements:!1,panelFixed:!0,panelHide:!1,reload:!1,lang:"ru-RU"},k={target:"string",fontSize:"number",theme:"string",images:"(string|boolean)",letterSpacing:"string",lineHeight:"string",speech:"boolean",fontFamily:"string",builtElements:"boolean",panelFixed:"boolean",panelHide:"boolean",reload:"boolean",lang:"string"},w={target:"",fontSize:"(^[1-9]$|^[1-3][0-9]?$|^39$)",theme:"(white|black|blue|brown|green)",images:"(true|false|grayscale)",letterSpacing:"(normal|average|big)",lineHeight:"(normal|average|big)",speech:"(true|false)",fontFamily:"(arial|times)",builtElements:"(true|false)",panelFixed:"(true|false)",panelHide:"(true|false)",reload:"(true|false)",lang:"(ru-RU|en-US)"};return{Bvi:function(){function t(e){n(this,t),this._config=this._getConfig(e),this._elements=document.querySelectorAll(this._config.target),this._i18n=new S({lang:this._config.lang}),this._addEventListeners(),this._init(),console.log("Bvi console: ready Button visually impaired v1.0.0")}return r(t,[{key:"_init",value:function(){h(this._config,function(e){void 0===p(e)&&g("panelActive")}),u(p("panelActive"))?(this._set(),this._getPanel(),this._addEventListenersPanel(),this._images(),this._speechPlayer(),"speechSynthesis"in window&&u(p("speech"))&&setInterval(function(){var e,t,n,i,o;!1===m().pending&&(e=document.querySelectorAll(".bvi-speech-play"),t=document.querySelectorAll(".bvi-speech-pause"),n=document.querySelectorAll(".bvi-speech-resume"),i=document.querySelectorAll(".bvi-speech-stop"),(o=function(e,t){e.forEach(function(e){return t(e)})})(e,function(e){return e.classList.remove("disabled")}),o(t,function(e){return e.classList.add("disabled")}),o(n,function(e){return e.classList.add("disabled")}),o(i,function(e){return e.classList.add("disabled")}))},1e3)):this._remove()}},{key:"_addEventListeners",value:function(){var t=this;if(!this._elements)return!1;this._elements.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),h(t._config,function(e){return b(e,t._config[e])}),b("panelActive",!0),t._init(),t._speech("".concat(t._i18n.v("panelOn")))})})}},{key:"_addEventListenersPanel",value:function(){function t(e){var t,n=a(e.parentNode.children);try{for(n.s();!(t=n.n()).done;)t.value.classList.remove("active")}catch(e){n.e(e)}finally{n.f()}e.classList.add("active")}function n(e,t){e.addEventListener("click",function(e){e.preventDefault(),"function"==typeof t&&t(e)})}function i(){document.querySelectorAll(".bvi-link").forEach(function(e){e.classList.remove("active")}),h(o._config,function(e){var t,n,i;"theme"===e&&(t=p(e),document.querySelector(".bvi-theme-".concat(t)).classList.add("active")),"images"===e&&(t="grayscale"===p(e)?"grayscale":u(p(e))?"on":"off",document.querySelector(".bvi-images-".concat(t)).classList.add("active")),"speech"===e&&(n=u(p(e))?"on":"off",document.querySelector(".bvi-speech-".concat(n)).classList.add("active")),"lineHeight"===e&&(n=p(e),document.querySelector(".bvi-line-height-".concat(n)).classList.add("active")),"letterSpacing"===e&&(i=p(e),document.querySelector(".bvi-letter-spacing-".concat(i)).classList.add("active")),"fontFamily"===e&&(i=p(e),document.querySelector(".bvi-font-family-".concat(i)).classList.add("active")),"builtElements"===e&&(e=u(p(e))?"on":"off",document.querySelector(".bvi-built-elements-".concat(e)).classList.add("active"))})}var o=this,r={fontSizeMinus:document.querySelector(".bvi-fontSize-minus"),fontSizePlus:document.querySelector(".bvi-fontSize-plus"),themeWhite:document.querySelector(".bvi-theme-white"),themeBlack:document.querySelector(".bvi-theme-black"),themeBlue:document.querySelector(".bvi-theme-blue"),themeBrown:document.querySelector(".bvi-theme-brown"),themeGreen:document.querySelector(".bvi-theme-green"),imagesOn:document.querySelector(".bvi-images-on"),imagesOff:document.querySelector(".bvi-images-off"),imagesGrayscale:document.querySelector(".bvi-images-grayscale"),speechOn:document.querySelector(".bvi-speech-on"),speechOff:document.querySelector(".bvi-speech-off"),lineHeightNormal:document.querySelector(".bvi-line-height-normal"),lineHeightAverage:document.querySelector(".bvi-line-height-average"),lineHeightBig:document.querySelector(".bvi-line-height-big"),letterSpacingNormal:document.querySelector(".bvi-letter-spacing-normal"),letterSpacingAverage:document.querySelector(".bvi-letter-spacing-average"),letterSpacingBig:document.querySelector(".bvi-letter-spacing-big"),fontFamilyArial:document.querySelector(".bvi-font-family-arial"),fontFamilyTimes:document.querySelector(".bvi-font-family-times"),builtElementsOn:document.querySelector(".bvi-built-elements-on"),builtElementsOff:document.querySelector(".bvi-built-elements-off"),reset:document.querySelector(".bvi-reset"),links:document.querySelectorAll(".bvi-link"),modal:document.querySelector(".bvi-modal")};i(),n(r.fontSizeMinus,function(){var e=parseFloat(p("fontSize"))-1;0!=e&&(o._setAttrDataBviBody("fontSize",e),b("fontSize",e),o._speech("".concat(o._i18n.v("fontSizeMinus"))),t(r.fontSizeMinus))}),n(r.fontSizePlus,function(){var e=parseFloat(p("fontSize"))+1;40!==e&&(o._setAttrDataBviBody("fontSize",e),b("fontSize",e),o._speech("".concat(o._i18n.v("fontSizePlus"))),t(r.fontSizePlus))}),n(r.themeWhite,function(){o._setAttrDataBviBody("theme","white"),b("theme","white"),o._speech("".concat(o._i18n.v("siteColorBlackOnWhite"))),t(r.themeWhite)}),n(r.themeBlack,function(){o._setAttrDataBviBody("theme","black"),b("theme","black"),o._speech("".concat(o._i18n.v("siteColorWhiteOnBlack"))),t(r.themeBlack)}),n(r.themeBlue,function(){o._setAttrDataBviBody("theme","blue"),b("theme","blue"),o._speech("".concat(o._i18n.v("siteColorDarkBlueOnBlue"))),t(r.themeBlue)}),n(r.themeBrown,function(){o._setAttrDataBviBody("theme","brown"),b("theme","brown"),o._speech("".concat(o._i18n.v("siteColorBeigeBrown"))),t(r.themeBrown)}),n(r.themeGreen,function(){o._setAttrDataBviBody("theme","green"),b("theme","green"),o._speech("".concat(o._i18n.v("siteColorGreenOnDarkBrown"))),t(r.themeGreen)}),n(r.imagesOn,function(){o._setAttrDataBviBody("images","true"),b("images","true"),o._speech("".concat(o._i18n.v("imagesOn"))),t(r.imagesOn)}),n(r.imagesOff,function(){o._setAttrDataBviBody("images","false"),b("images","false"),o._speech("".concat(o._i18n.v("imagesOFF"))),t(r.imagesOff)}),n(r.imagesGrayscale,function(){o._setAttrDataBviBody("images","grayscale"),b("images","grayscale"),o._speech("".concat(o._i18n.v("imagesGrayscale"))),t(r.imagesGrayscale)}),n(r.speechOn,function(){o._setAttrDataBviBody("speech","true"),b("speech","true"),o._speech("".concat(o._i18n.v("speechOn"))),t(r.speechOn),o._speechPlayer()}),n(r.speechOff,function(){o._speech("".concat(o._i18n.v("speechOff"))),o._setAttrDataBviBody("speech","false"),b("speech","false"),t(r.speechOff),o._speechPlayer()}),n(r.lineHeightNormal,function(){o._setAttrDataBviBody("lineHeight","normal"),b("lineHeight","normal"),o._speech("".concat(o._i18n.v("lineHeightNormal"))),t(r.lineHeightNormal)}),n(r.lineHeightAverage,function(){o._setAttrDataBviBody("lineHeight","average"),b("lineHeight","average"),o._speech("".concat(o._i18n.v("lineHeightAverage"))),t(r.lineHeightAverage)}),n(r.lineHeightBig,function(){o._setAttrDataBviBody("lineHeight","big"),b("lineHeight","big"),o._speech("".concat(o._i18n.v("lineHeightBig"))),t(r.lineHeightBig)}),n(r.letterSpacingNormal,function(){o._setAttrDataBviBody("letterSpacing","normal"),b("letterSpacing","normal"),o._speech("".concat(o._i18n.v("LetterSpacingNormal"))),t(r.letterSpacingNormal)}),n(r.letterSpacingAverage,function(){o._setAttrDataBviBody("letterSpacing","average"),b("letterSpacing","average"),o._speech("".concat(o._i18n.v("LetterSpacingAverage"))),t(r.letterSpacingAverage)}),n(r.letterSpacingBig,function(){o._setAttrDataBviBody("letterSpacing","big"),b("letterSpacing","big"),o._speech("".concat(o._i18n.v("LetterSpacingBig"))),t(r.letterSpacingBig)}),n(r.fontFamilyArial,function(){o._setAttrDataBviBody("fontFamily","arial"),b("fontFamily","arial"),o._speech("".concat(o._i18n.v("fontArial"))),t(r.fontFamilyArial)}),n(r.fontFamilyTimes,function(){o._setAttrDataBviBody("fontFamily","times"),b("fontFamily","times"),o._speech("".concat(o._i18n.v("fontTimes"))),t(r.fontFamilyTimes)}),n(r.builtElementsOn,function(){o._setAttrDataBviBody("builtElements","true"),b("builtElements","true"),o._speech("".concat(o._i18n.v("builtElementsOn"))),t(r.builtElementsOn)}),n(r.builtElementsOff,function(){o._setAttrDataBviBody("builtElements","false"),b("builtElements","false"),o._speech("".concat(o._i18n.v("builtElementsOFF"))),t(r.builtElementsOff)}),n(r.reset,function(){o._speech("".concat(o._i18n.v("resetSettings"))),h(o._config,function(e){o._setAttrDataBviBody(e,o._config[e]),b(e,o._config[e]),i()})}),d(r.links,function(e){n(e,function(e){e=e.target.getAttribute("data-bvi");"close"===e&&(o._setAttrDataBviBody("panelActive","false"),b("panelActive","false"),o._init()),"modal"===e&&(document.body.style.overflow="hidden",document.body.classList.add("bvi-noscroll"),r.modal.classList.toggle("show")),"modal-close"===e&&(document.body.classList.remove("bvi-noscroll"),document.body.style.overflow="",r.modal.classList.remove("show")),"panel-hide"===e&&(document.querySelector(".bvi-panel").classList.add("bvi-panel-hide"),document.querySelector(".bvi-link-fixed-top").classList.remove("bvi-hide"),document.querySelector(".bvi-link-fixed-top").classList.add("bvi-show"),b("panelHide","true"),o._speech("".concat(o._i18n.v("panelHide")))),"panel-show"===e&&(document.querySelector(".bvi-link-fixed-top").classList.remove("bvi-show"),document.querySelector(".bvi-link-fixed-top").classList.add("bvi-hide"),document.querySelector(".bvi-panel").classList.remove("bvi-panel-hide"),b("panelHide","false"),o._speech("".concat(o._i18n.v("panelShow"))))})}),n(r.modal,function(e){e.target.contains(r.modal)&&(document.body.classList.remove("bvi-noscroll"),document.body.style.overflow="",r.modal.classList.remove("show"))})}},{key:"_getPanel",value:function(){function e(){var e=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;u(p("panelFixed"))&&(200<e?document.querySelector(".bvi-panel").classList.add("bvi-fixed-top"):document.querySelector(".bvi-panel").classList.remove("bvi-fixed-top"))}var t=u(p("panelHide"))?" bvi-panel-hide":"",n=u(p("panelHide"))?"bvi-show":" bvi-hide",t="\n    <div class='bvi-panel".concat(t,'\'>\n        <div class="bvi-blocks bvi-block-center">\n            <div class="bvi-block">\n                <div class="bvi-block-title">').concat(this._i18n.t("fontSize"),'</div>\n                <a class="bvi-link bvi-fontSize-minus">А-</a>\n                <a class="bvi-link bvi-fontSize-plus">А+</a>\n            </div>\n            <div class="bvi-block">\n                <div class="bvi-block-title">').concat(this._i18n.t("siteColors"),'</div>\n                <a href="#" class="bvi-link bvi-theme-white">Ц</a>\n                <a href="#" class="bvi-link bvi-theme-black">Ц</a>\n                <a href="#" class="bvi-link bvi-theme-blue">Ц</a>\n                <a href="#" class="bvi-link bvi-theme-brown">Ц</a>\n                <a href="#" class="bvi-link bvi-theme-green">Ц</a>\n            </div>\n            <div class="bvi-block">\n                <div class="bvi-block-title">').concat(this._i18n.t("images"),'</div>\n                <a href="#" class="bvi-link bvi-images-on">\n                    <i class="bvi-images bvi-images-image"></i>\n                </a>\n                <a href="#" class="bvi-link bvi-images-off">\n                    <i class="bvi-images bvi-images-minus-circle"></i>\n                </a>\n                <a href="#" class="bvi-link bvi-images-grayscale">\n                    <i class="bvi-images bvi-images-adjust"></i>\n                </a>\n            </div>\n            <div class="bvi-block">\n                <div class="bvi-block-title">').concat(this._i18n.t("speech"),'</div>\n                <a href="#" class="bvi-link bvi-speech-off">\n                    <i class="bvi-images bvi-images-volume-off"></i>\n                </a>\n                <a href="#" class="bvi-link bvi-speech-on">\n                    <i class="bvi-images bvi-images-volume-up"></i>\n                </a>\n            </div>\n            <div class="bvi-block">\n                <div class="bvi-block-title">').concat(this._i18n.t("settings"),'</div>\n                <a href="#" class="bvi-link" data-bvi="modal">\n                    <i class="bvi-images bvi-images-cog"></i>\n                </a>\n                <a href="#" class="bvi-link" data-bvi="close">\n                    ').concat(this._i18n.t("regularVersionOfTheSite"),'\n                </a>\n                <a href="#" class="bvi-link" data-bvi="panel-hide">\n                    <i class="bvi-images bvi-images-minus"></i>\n                </a>\n            </div>\n        </div>\n        <div class="bvi-modal">\n            <div class="bvi-modal-dialog">\n                <div class="bvi-modal-content">\n                    <div class="bvi-modal-header">\n                        <div class="bvi-modal-title">').concat(this._i18n.t("settings"),'</div>\n                        <a href="#" class="bvi-link bvi-modal-close" data-bvi="modal-close">×</a>\n                    </div>\n                    <div class="bvi-modal-body">\n                        <div class="bvi-blocks bvi-block-center">\n                            <div class="bvi-block">\n                                <div class="bvi-block-title">').concat(this._i18n.t("letterSpacing"),'</div>\n                                <a href="#" class="bvi-link bvi-letter-spacing-normal">').concat(this._i18n.t("normal"),'</a>\n                                <a href="#" class="bvi-link bvi-letter-spacing-average">').concat(this._i18n.t("average"),'</a>\n                                <a href="#" class="bvi-link bvi-letter-spacing-big">').concat(this._i18n.t("big"),'</a>\n                            </div>\n                            <div class="bvi-block">\n                                <div class="bvi-block-title">').concat(this._i18n.t("lineHeight"),'</div>\n                                <a href="#" class="bvi-link bvi-line-height-normal">').concat(this._i18n.t("normal"),'</a>\n                                <a href="#" class="bvi-link bvi-line-height-average">').concat(this._i18n.t("average"),'</a>\n                                <a href="#" class="bvi-link bvi-line-height-big">').concat(this._i18n.t("big"),'</a>\n                            </div>\n                            <div class="bvi-block">\n                                <div class="bvi-block-title">').concat(this._i18n.t("font"),'</div>\n                                <a href="#" class="bvi-link bvi-font-family-arial">').concat(this._i18n.t("arial"),'</a>\n                                <a href="#" class="bvi-link bvi-font-family-times">').concat(this._i18n.t("times"),'</a>\n                            </div>\n                            <div class="bvi-block">\n                                <div class="bvi-block-title">').concat(this._i18n.t("builtElements"),'</div>\n                                <a href="#" class="bvi-link bvi-built-elements-on">').concat(this._i18n.t("on"),'</a>\n                                <a href="#" class="bvi-link bvi-built-elements-off">').concat(this._i18n.t("off"),'</a>\n                            </div>\n                        </div>\n                        <div class="bvi-blocks bvi-block-center">\n                            <a href="https://bvi.isvek.ru" class="bvi-copyright" target="_blank">bvi.isvek.ru</a>\n                        </div>\n                    </div>\n                    <div class="bvi-modal-footer">\n                        <a href="#" class="bvi-link bvi-reset">').concat(this._i18n.t("reset"),"</a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>"),n='<a href="#" class="bvi-link bvi-link-fixed-top bvi-no-styles '.concat(n,'" data-bvi="panel-show">')+'<i class="bvi-images bvi-images-eye bvi-images-size-32 bvi-no-styles"></i></a>';window.addEventListener("scroll",e),document.querySelector(".bvi-body").insertAdjacentHTML("beforebegin",t),document.querySelector(".bvi-body").insertAdjacentHTML("afterbegin",n),e()}},{key:"_set",value:function(){var t=this;document.body.classList.add("bvi-active"),v(document.body,"div","bvi-body"),h(this._config,function(e){return t._setAttrDataBviBody(e,p(e))}),d(this._elements,function(e){return e.style.display="none"}),document.querySelectorAll("img").forEach(function(e){e.classList.contains("bvi-img")&&e.classList.remove("bvi-img")}),document.querySelectorAll("body *").forEach(function(e){e.classList.contains("bvi-background-image")&&e.classList.remove("bvi-background-image")})}},{key:"_remove",value:function(){var e=document.querySelector(".bvi-panel"),t=document.querySelector(".bvi-body"),n=document.querySelector(".bvi-link-fixed-top");e&&e.remove(),t&&f(t),n&&n.remove(),this._speech("".concat(this._i18n.v("panelOff"))),document.body.classList.remove("bvi-active"),d(this._elements,function(e){return e.style.display=""}),u(p("reload"))&&document.location.reload(),h(this._config,function(e){g(e)}),this._speechPlayer(),g("panelActive")}},{key:"_images",value:function(){document.querySelectorAll("img").forEach(function(e){e.classList.contains("bvi-no-style")||e.classList.add("bvi-img")}),document.querySelectorAll(".bvi-body *").forEach(function(e){var t=getComputedStyle(e);"none"===t.backgroundImage||"none"===t.background||e.classList.contains("bvi-no-style")||e.classList.add("bvi-background-image")})}},{key:"_getConfig",value:function(e){e=i(i({},_),e);var t,n={};for(t in _)n[t]=e[t];return s(n,k,w),n}},{key:"_setAttrDataBviBody",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";document.querySelector(".bvi-body").setAttribute("data-bvi-".concat(e),t)}},{key:"_speechPlayer",value:function(){var e,t,n,i,l=this,o=document.querySelectorAll(".bvi-speech-text"),r=document.querySelectorAll(".bvi-speech-link"),a=document.querySelectorAll(".bvi-speech");"speechSynthesis"in window&&u(p("speech"))?a&&(o&&o.forEach(f),r&&r.forEach(function(e){return e.remove()}),a.forEach(function(e,t){t="bvi-speech-text-id-".concat(t+1);v(e,"div","bvi-speech-text ".concat(t)),e.insertAdjacentHTML("afterbegin",'\n            <div class="bvi-speech-link">\n              <a href="#" class="bvi-link bvi-speech-play" title="Воспроизвести">Воспроизвести</a>\n              <a href="#" class="bvi-link bvi-speech-pause disabled" title="Пауза">Пауза</a>\n              <a href="#" class="bvi-link bvi-speech-resume disabled" title="Продолжить">Продолжить</a>\n              <a href="#" class="bvi-link bvi-speech-stop disabled" title="Стоп">Стоп</i></a>\n          </div>')}),e=document.querySelectorAll(".bvi-speech-play"),t=document.querySelectorAll(".bvi-speech-pause"),n=document.querySelectorAll(".bvi-speech-resume"),i=document.querySelectorAll(".bvi-speech-stop"),(a=function(e,n){e.forEach(function(t){t.addEventListener("click",function(e){if(e.preventDefault(),"function"==typeof n)return n(t,e)},!1)})})(e,function(e,t){var n=t.target,i=n.parentNode.nextElementSibling,o=t.target.closest(".bvi-speech-link"),r=document.querySelectorAll(".bvi-speech-play"),a=document.querySelectorAll(".bvi-speech-pause"),c=document.querySelectorAll(".bvi-speech-resume"),t=document.querySelectorAll(".bvi-speech-stop");l._speech(i.textContent,i,!0),r.forEach(function(e){return e.classList.remove("disabled")}),a.forEach(function(e){return e.classList.add("disabled")}),c.forEach(function(e){return e.classList.add("disabled")}),t.forEach(function(e){return e.classList.add("disabled")}),n.classList.add("disabled"),o.querySelector(".bvi-speech-pause").classList.remove("disabled"),o.querySelector(".bvi-speech-stop").classList.remove("disabled")}),a(t,function(e,t){var n=t.target,t=t.target.closest(".bvi-speech-link");n.classList.add("disabled"),t.querySelector(".bvi-speech-resume").classList.remove("disabled"),m().pause()}),a(n,function(e,t){var n=t.target,t=t.target.closest(".bvi-speech-link");n.classList.add("disabled"),t.querySelector(".bvi-speech-pause").classList.remove("disabled"),m().resume()}),a(i,function(e,t){var n=t.target,t=t.target.closest(".bvi-speech-link");n.classList.add("disabled"),t.querySelector(".bvi-speech-pause").classList.add("disabled"),t.querySelector(".bvi-speech-play").classList.remove("disabled"),m().cancel()})):(o&&o.forEach(f),r&&r.forEach(function(e){return e.remove()}))}},{key:"_speech",value:function(e,i){var o=this,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if("speechSynthesis"in window&&u(p("speech"))){m().cancel();for(var t=new RegExp("^[\\s\\S]{"+Math.floor(60)+",120}[.!?,]{1}|^[\\s\\S]{1,120}$|^[\\s\\S]{1,120} "),n=[],a=e,c=m().getVoices();0<a.length;)n.push(a.match(t)[0]),a=a.substring(n[n.length-1].length);n.forEach(function(e){var t=new SpeechSynthesisUtterance(e.trim());t.volume=1,t.rate=1,t.pitch=1,t.lang=o._config.lang;for(var n=0;n<c.length;n++)"ru-RU"===o._config.lang&&"Microsoft Pavel - Russian (Russia)"===c[n].name&&(t.voice=c[n]),"en-US"===o._config.lang&&"Microsoft Pavel - English (English)"===c[n].name&&(t.voice=c[n]);r&&(t.onboundary=function(e){i.classList.add("bvi-highlighting");var t=function(e,t){e=String(e),t=Number(t)>>>0;var n=e.slice(0,t+1).search(/\S+$/),i=e.slice(t).search(/\s/);return i<0?e.slice(n):e.slice(n,i+t)}(e.utterance.text,e.charIndex),e=i.textContent,t=t.replace(/(\s+)/,"((<[^>]+>)*$1(<[^>]+>)*)"),t=new RegExp("("+t+")","gi");e=(e=e.replace(t,"<mark>$1</mark>")).replace(/(<mark>[^<>]*)((<[^>]+>)+)([^<>]*<\/mark>)/,"$1</mark>$2<mark>$4"),i.innerHTML=e},t.onend=function(e){i.classList.remove("bvi-highlighting");var t=(t=i.textContent).replace(/(<mark>$1<\/mark>)/,"$1");i.innerHTML=t}),m().speak(t)})}}}]),t}()}});
//# sourceMappingURL=bvi.min.js.map
